## OTUS Linux Professional - Урок 3. Автоматизация администрирования. Ansible-1.

#### ЦЕЛЬ: УСТАНОВИТЬ И НАСТРОИТЬ NGINX С ПОМОЩЬЮ ANSIBLE.

#### УСЛОВИЯ ВЫПОЛНЕНИЯ:
- использовать apt/yum
- конфигурационные файлы nginx должны быть взяты из шаблонов jinja2, шаблоны должны использовать переменные
- после установки nginx должен быть в режиме enabled в systemd
- должен быть использован notify для старта nginx после установки
- сайт должен слушать на нестандартном порту - 8080, для указания порта использовать переменные

#### ПОРЯДОК ДЕЙСТВИЙ:

1. Запускаем виртуальную машину, используя Vagrantfile:
```
vagrant up
```
3. Выполняем playbook `nginx.yml`:
```
ansible-playbook nginx.yml
```
#### ОПИСАНИЕ: 

Плейбук `nginx.yml` выполняет следующие действия над  виртуальными машинами группы `[web]`:

- Обновляет apt cache
-  Устанавливает nginx
-  Устанавливает статус сервиса nginx - enabled
-  Копирует конфигурационный файл виртуального хоста nginx на виртуальную машину в каталог `/etc/nginx/sites-available/`
-  Копирует индексную страницу на виртуальную машину в каталог `/var/www/html`
-  Создает символьную ссылку `/etc/nginx/sites-enabled/vhost-otus` на файл `/etc/nginx/sites-available/vhost-otus`
-  Запускает nginx

#### РЕЗУЛЬТАТ:

После выполнения playbook'а имеем Nginx с двумя virtual host:
- дефолтный virtual host слушает на порту **80** и отдает **дефолтный index.html**
- наш кастомный virtual host слушает на порту **8080** и отдает наш **кастомный index.html**

ПРИМЕЧАНИЕ: 
Перед запуском playbook'a нужно в `staging/hosts` заменить приватный ключ на свой (смотреть коммандой `vagrant ssh-config`)